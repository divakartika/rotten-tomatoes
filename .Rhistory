year_meter$year <- as.numeric(year_meter$year)
ggplot(data = year_meter, mapping = aes(x = year, y = Freq)) +
geom_line()
year_meter$year <- as.numeric(year_meter$year)
year_meter
year_meter <- as.data.frame(xtabs(formula = ~year+tomatometer, data = rt_clean))
year_meter$year <- as.integer(year_meter$year)
year_meter
year_meter <- as.data.frame(xtabs(formula = ~year+tomatometer, data = rt_clean))
year_meter$year <- as.integer(as.character(year_meter$year))
year_meter
ggplot(data = year_meter, mapping = aes(x = year, y = Freq)) +
geom_line()
year_meter <- as.data.frame.matrix(xtabs(formula = ~year+tomatometer, data = rt_clean))
# year_meter$year <- as.integer(as.character(year_meter$year))
year_meter
ggplot(data = year_meter, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh))
year_meter <- as.data.frame.matrix(xtabs(formula = ~year, data = rt_clean))
year_meter <- as.data.frame(xtabs(formula = ~year, data = rt_clean))
# year_meter$year <- as.integer(as.character(year_meter$year))
year_meter
# year_meter$year <- as.integer(as.character(year_meter$year))
year_meter <- cbind(year = rownames(year_meter), year_meter)
year_meter <- as.data.frame(xtabs(formula = ~year, data = rt_clean))
# year_meter$year <- as.integer(as.character(year_meter$year))
year_meter <- cbind(year = rownames(year_meter), year_meter)
year_meter
year_meter <- as.data.frame(xtabs(formula = ~year+tomatometer, data = rt_clean))
# year_meter$year <- as.integer(as.character(year_meter$year))
year_meter <- cbind(year = rownames(year_meter), year_meter)
year_meter
table(rt_clean$year, rt_clean$tomatometer)
as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
pivot_wider(data = year_meter, id_cols = Var1, id_expand = Var2)
pivot_wider(data = year_meter, id_cols = "Var1", id_expand = "Var2")
pivot_wider(data = year_meter, id_expand = "Var2")
pivot_wider(data = year_meter, id_cols = "Var2")
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
pivot_wider(data = year_meter, id_cols = "Var2")
rt_clean %>%
group_by(year) %>%
summarise(freq = count(year))
# clear-up the environment
rm(list = ls())
# chunk options
knitr::opts_chunk$set(
fig.align = "center",
message = FALSE,
warning = FALSE
)
library(reshape2)
library(lubridate) # for datetime-related data processing
library(tidyverse)
rt <- read.csv("data/rotten_tomatoes_top_movies.csv")
head(rt)
rt <-
rt %>%
select(-c(X, link))
sum(duplicated(rt))
sum(duplicated(rt$title, ))
rt[duplicated(rt$title), ]
rt[rt$title == "Spider-Man: Into the Spider-Verse", ]
rt[rt$title == "The LEGO Movie", ]
rt_clean <- rt[!duplicated(rt$title, fromLast = TRUE), ]
rt_clean
rt_clean <- subset(rt_clean, select = -genre)
head(rt_clean)
str(rt_clean)
glimpse(rt_clean)
rt_clean[rt_clean == ""] <- NA
glimpse(rt_clean)
colSums(is.na(x = rt_clean))
rt_clean <-
subset(rt_clean, select = -c(consensus, rating, writer, release_date_.theaters.,
box_office_.gross_usa., sound_mix, aspect_ratio,
view_the_collection))
colSums(is.na(x = rt_clean))
rt_clean
rt_clean <-
rt_clean %>%
mutate_at(c("synopsis", "director", "producer", "production_co"),
~replace_na(., "Unknown")) %>%
mutate_at("original_language",
~replace_na(., "Unknown language"))
colSums(is.na(x = rt_clean))
summary(rt_clean$people_score)
rt_clean$people_score[is.na(rt_clean$people_score)] <- median(rt_clean$people_score, na.rm = TRUE)
summary(rt_clean$people_score)
glimpse(rt_clean)
# mengganti tipe data menjadi factor
cols <- c("total_ratings", "type", "original_language")
rt_clean[cols] <- lapply(X = rt_clean[cols], FUN = as.factor)
rt_clean[cols]
# mengganti tipe data menjadi date
rt_clean$release_date_.streaming. <- mdy(rt_clean$release_date_.streaming.)
rt_clean["release_date_.streaming."]
head(rt_clean)
summary(rt_clean$year)
hist(rt_clean$year)
table(rt_clean$type)
sort(table(rt_clean$type), decreasing = T)
plot(rt_clean$type)
rt_clean[rt_clean$type == "Science Fiction & Fantasy", ]
summary(rt_clean[rt_clean$type == "Science Fiction & Fantasy", "year"])
sort(table(rt_clean$original_language), decreasing = T)
head(sort(table(rt_clean$director), decreasing = T))
rt_clean %>%
filter(director %in% c("Alfred Hitchcock", "Steven Spielberg", "Howard Hawks")) %>%
arrange(desc(year))
type_freq <- as.data.frame(table(rt_clean$type))
type_freq
ggplot(data = type_freq, mapping = aes(x = Var1, y = Freq)) +
geom_col()
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col()
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col() +
coord_flip()
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col() +
geom_text(aes(label = Freq)) +
coord_flip()
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col() +
geom_text(aes(label = Freq)) +
coord_flip() +
labs(x = "Genre Type",
y = "Frequency")
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col() +
geom_text(aes(label = Freq)) +
coord_flip() +
labs(x = "Genre Type",
y = "Frequency",
title = "Rotten Tomatoes: Critic Score Distribution",
subtitle = "Year of 1919 to 2020")
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col(fill = "#7393B3") +
geom_text(aes(label = Freq), color = "#36454F") +
coord_flip() +
labs(x = "Genre Type",
y = "Frequency",
title = "Rotten Tomatoes: Critic Score Distribution",
subtitle = "Year of 1919 to 2020")
ggplot(data = type_freq, mapping = aes(x = reorder(Var1, Freq), y = Freq)) +
geom_col(fill = "#7393B3") +
geom_text(aes(label = Freq), color = "#36454F") +
coord_flip() +
labs(x = "Genre Type",
y = "Frequency",
title = "Rotten Tomatoes: Critic Score Distribution",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = rt_clean, mapping = aes(x = critic_score)) +
geom_histogram(fill = "#7393B3") +
labs(x = "Critic Score",
y = "Frequency",
title = "Rotten Tomatoes: Critic Score Distribution",
subtitle = "Year of 1919 to 2020")+
theme_light()
ggplot(data = rt_clean, mapping = aes(x = people_score)) +
geom_histogram(fill = "#7393B3") +
labs(x = "People Score",
y = "Frequency",
title = "Rotten Tomatoes: People Score Distribution",
subtitle = "Year of 1919 to 2020")+
theme_light()
score_melt <-
melt(rt_clean[c("critic_score", "people_score")])
levels(score_melt$variable) <- c("Critic Score", "People Score")
score_melt
ggplot(data = score_melt, mapping = aes(x = variable, y = value)) +
geom_boxplot(fill = "#7393B3", color = "#36454F") +
coord_flip() +
labs(x = "",
y = "Score",
title = "Rotten Tomatoes: Score Distribution Comparison",
subtitle = "People Score vs. Critic Score\nYear of 1919 to 2020") +
theme_light()
ggplot(data = rt_clean, mapping = aes(x = total_reviews, y = critic_score)) +
geom_point(color = "#6082B6") +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
rt_clean$tomatometer <- ifelse(test = rt_clean$critic_score >= 60,
yes = "fresh",
no = "rotten")
# melihat 5 data random dari tomatometer
sample(rt_clean$tomatometer, size = 5)
rt_clean %>%
group_by(year, tomatometer) %>%
summarise(freq = count(year))
year_meter <- as.data.frame(table(year, tomatometer))
year_meter <- as.data.frame(table(year, tomatometer))
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
year_meter
year_meter %>%
group_by(Var1, Var2) %>%
summarise(freq = Freq)
year_meter %>%
group_by(Var1, Var2) %>%
summarise(freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq)
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq)
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.factor)
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.factor(Var1))
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(Var1))
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1)))
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1))) %>%
rename(year = Var1)
year_meter <-
year_meter %>%
group_by(Var1, Var2) %>%
# summarise(Freq = Freq) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1))) %>%
rename(year = Var1)
ggplot(data = year_meter, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh))
ggplot(data = year_meter, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh)) +
geom_line(mapping = aes(y = rotten))
year_meter_wider <-
year_meter %>%
group_by(Var1, Var2) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1))) %>%
rename(year = Var1)
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
year_meter
year_meter_wider <-
year_meter %>%
group_by(Var1, Var2) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1))) %>%
rename(year = Var1)
year_meter_wider
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
head(year_meter)
year_meter_wider <-
year_meter %>%
group_by(Var1, Var2) %>%
pivot_wider(names_from = Var2, values_from = Freq) %>%
mutate(Var1 = as.integer(as.character(Var1))) %>%
rename(year = Var1)
head(year_meter_wider)
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh)) +
geom_line(mapping = aes(y = rotten)) +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato") +
geom_line(mapping = aes(y = rotten)) +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato") +
geom_line(mapping = aes(y = rotten), color = "violet") +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato") +
geom_line(mapping = aes(y = rotten), color = "violet") +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggsave("assets/fresh_rotten.png")
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato", size = 3) +
geom_line(mapping = aes(y = rotten), color = "violet") +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggsave("assets/fresh_rotten.png")
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato", size = 1) +
geom_line(mapping = aes(y = rotten), color = "violet") +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato", size = 1) +
geom_line(mapping = aes(y = rotten), color = "violet", size = 1) +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggplot(data = year_meter_wider, mapping = aes(x = year)) +
geom_line(mapping = aes(y = fresh), color = "tomato", size = 1) +
geom_line(mapping = aes(y = rotten), color = "purple", size = 1) +
labs(x = "Total Reviews",
y = "Critic Score",
title = "Rotten Tomatoes: Reviewer Amount and Their Score",
subtitle = "Year of 1919 to 2020") +
theme_light()
ggsave("assets/fresh_rotten.png")
ggplot(data = year_meter, mapping = aes(x = as.integer(as.character(Var1)))) +
geom_line(mapping = aes(y = Freq, color = Var2), size = 1)
year_meter$Var1 <- as.integer(as.character(Var1))
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
head(year_meter)
year_meter$Var1 <- as.integer(as.character(year_meter$Var1))
class(year_meter$Var1)
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1)
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2))
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
theme_light()
rt_clean$tomatometer <- ifelse(test = rt_clean$critic_score >= 60,
yes = "Fresh",
no = "Rotten")
# melihat 5 data random dari tomatometer
sample(rt_clean$tomatometer, size = 5)
year_meter <- as.data.frame(table(rt_clean$year, rt_clean$tomatometer))
head(year_meter)
year_meter$Var1 <- as.integer(as.character(year_meter$Var1))
class(year_meter$Var1)
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark purple"))
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "purple"))
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "purple")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "purple")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "blue")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark blue")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "purple")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "grey")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark grey")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "Tomatometer",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark grey")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "Tomatometer",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2)) +
labs(x = "Year",
y = "Amount of Film/TV Show",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "Tomatometer®",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark grey")) +
theme_light()
ggplot(data = year_meter, mapping = aes(x = Var1, y = Freq)) +
geom_line(mapping = aes(color = Var2), size = 1) +
labs(x = "Year",
y = "Amount of Film/TV Show",
color = "Tomatometer®",
title = "Rotten Tomatoes: Amount of Film by Year",
subtitle = "Fresh vs. Rotten\nYear of 1919 to 2020") +
scale_color_manual(values = c("tomato", "dark grey")) +
theme_light()
ggplot(data = top_director, mapping = aes(x = director, y = critic_score)) +
geom_jitter(mapping = aes(color = type))
top_director <-
rt_clean %>%
filter(director %in% c("Alfred Hitchcock", "Steven Spielberg", "Howard Hawks")) %>%
arrange(desc(year))
ggplot(data = top_director, mapping = aes(x = director, y = critic_score)) +
geom_jitter(mapping = aes(color = type))
ggplot(data = top_director, mapping = aes(x = director, y = critic_score)) +
geom_point(mapping = aes(color = type))
ggplot(data = top_director, mapping = aes(x = director, y = critic_score)) +
geom_jitter(mapping = aes(color = type))
ggplot(data = top_director, mapping = aes(x = director, y = critic_score)) +
geom_boxplot() +
geom_jitter(mapping = aes(color = type))
